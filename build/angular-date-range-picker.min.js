/*! angular-date-range-picker 2014-09-09 */
(function(){var a={}.hasOwnProperty;angular.module("dateRangePicker",["pasvaz.bindonce"]),angular.module("dateRangePicker").directive("dateRangePicker",["$compile","$timeout",function(b,c){var d,e;return e='<div ng-show="visible" class="angular-date-range-picker__picker" ng-click="handlePickerClick($event)" ng-class="{\'angular-date-range-picker--ranged\': showRanged }" ng-cloak>\n  <div class="angular-date-range-picker__timesheet">\n    <a ng-click="move(-1, $event)" class="angular-date-range-picker__prev-month">&#9664;</a>\n    <div bindonce ng-repeat="month in months" class="angular-date-range-picker__month">\n      <div class="angular-date-range-picker__month-name" bo-text="month.name"></div>\n      <table class="angular-date-range-picker__calendar">\n        <tr>\n          <th bindonce ng-repeat="day in month.weeks[1]" class="angular-date-range-picker__calendar-weekday" bo-text="day.date.format(\'dd\')">\n          </th>\n        </tr>\n        <tr bindonce ng-repeat="week in month.weeks">\n          <td\n              bo-class=\'{\n                "angular-date-range-picker__calendar-day": day,\n                "angular-date-range-picker__calendar-day-selected-0": day.selected[0],\n                "angular-date-range-picker__calendar-day-selected-1": day.selected[1],\n                "angular-date-range-picker__calendar-day-disabled": day.disabled,\n                "angular-date-range-picker__calendar-day-start": day.start\n              }\'\n              ng-repeat="day in week track by $index" ng-click="select(day, $event)">\n              <div class="angular-date-range-picker__calendar-day-wrapper" bo-text="day.date.date()"></div>\n          </td>\n        </tr>\n      </table>\n    </div>\n    <a ng-click="move(+1, $event)" class="angular-date-range-picker__next-month">&#9654;</a>\n  </div>\n  <div class="angular-date-range-picker__panel">\n    <div ng-show="showRanged">\n      Select range: <select ng-click="prevent_select($event)" ng-model="quick" ng-options="e.range as e.label for e in quickList"></select>\n    </div>\n    <input type="text" id="datebox_0_start" class="angular-date-range-picker__datebox" ng-focus="cursel=0" ng-blur="setDate($event,0,0)" placeholder="YYYY-MM-DD"/>\n    <input type="text" id="datebox_0_end" class="angular-date-range-picker__datebox" ng-focus="cursel=0" ng-blur="setDate($event,0,1)" placeholder="YYYY-MM-DD"/><br/>\n    <label class="angular-date-range-picker__comparelabel">\n      <input type="checkbox" ng-model="showcomp" ng-true-value="1" ng-false-value="0" ng-change="flipCompare()"/> Compare to...</label>\n    </label>\n    <div ng-show="showcomp">\n      <input type="text" id="datebox_1_start" class="angular-date-range-picker__datebox" ng-focus="cursel=1" ng-blur="setDate($event,1,0)" placeholder="YYYY-MM-DD"/>\n      <input type="text" id="datebox_1_end" class="angular-date-range-picker__datebox" ng-focus="cursel=1" ng-blur="setDate($event,1,1)" placeholder="YYYY-MM-DD"/><br/>\n    </div>\n    <div class="angular-date-range-picker__buttons">\n      <a ng-click="ok($event)" class="angular-date-range-picker__apply">Apply</a>\n      <a ng-click="hide($event)" class="angular-date-range-picker__cancel">cancel</a>\n    </div>\n  </div>\n</div>',d="CUSTOM",{restrict:"AE",replace:!0,template:'<span tabindex="0" class="angular-date-range-picker__input">\n  <span ng-if="showRanged">\n    <span ng-show="model && model.0">{{ model.0.start.format("ll") }} - {{ model.0.end.format("ll") }}</span>\n    <span ng-hide="model && model.0">Select date range</span>\n  </span>\n  <span ng-if="!showRanged">\n    <span ng-show="model && model.0">{{ model.0.format("ll") }}</span>\n    <span ng-hide="model && model.0">Select date</span>\n  </span>\n</span>',scope:{model:"=ngModel",customSelectOptions:"=",ranged:"=",pastDates:"@",noFutureDates:"@",callback:"&"},link:function(f,g){var h,i,j,k,l,m,n;return f.quickListDefinitions=f.customSelectOptions,null==f.quickListDefinitions&&(f.quickListDefinitions=[{label:"This week",range:moment().range(moment().startOf("week").startOf("day"),moment().endOf("week").startOf("day"))},{label:"Next week",range:moment().range(moment().startOf("week").add(1,"week").startOf("day"),moment().add(1,"week").endOf("week").startOf("day"))},{label:"This fortnight",range:moment().range(moment().startOf("week").startOf("day"),moment().add(1,"week").endOf("week").startOf("day"))},{label:"This month",range:moment().range(moment().startOf("month").startOf("day"),moment().endOf("month").startOf("day"))},{label:"Next month",range:moment().range(moment().startOf("month").add(1,"month").startOf("day"),moment().add(1,"month").endOf("month").startOf("day"))}]),f.quick=null,f.range=null,f.selecting=!1,f.visible=!1,f.start=null,f.cursel=0,f.showcomp=!1,f.selection=[],f.showRanged=void 0===f.ranged?!0:f.ranged,f.showCompare=void 0===f.compare?!0:f.compare,f.setDate=function(a,b,c){var d,e,g;return e=moment(a.target.value,["YYYY-MM-DD","MM/DD/YY","MM/DD/YYYY"]),e.isValid()?(f.selection[b]?c?f.selection[b].end=e:f.selection[b].start=e:(g=e.clone(),d=e.clone(),c?g.add("d",-1):d.add("d",1),f.selection[b]=moment().range(g,d)),n()):void 0},f.flipCompare=function(){return f.cursel=parseInt(f.showcomp)},f.$watchCollection("selection",function(a){var b,c,d;for(d=[],b=c=0;1>=c;b=++c)a&&a[b]?(document.getElementById("datebox_"+b+"_start").value=a[b].start.format("YYYY-MM-DD"),d.push(document.getElementById("datebox_"+b+"_end").value=a[b].end.format("YYYY-MM-DD"))):d.push(void 0);return d}),l=function(a){return null==a&&(a=0),f.showCompare?(f.model||(f.model=[]),f.model[a]):f.model},m=function(a){var b,c,e,g,h;if(null==a&&(a=!1),f.showRanged){for(f.quickList=[],a&&f.quickList.push({label:"Custom",range:d}),g=f.quickListDefinitions,h=[],c=0,e=g.length;e>c;c++)b=g[c],h.push(f.quickList.push(b));return h}},j=function(){var a,b,c,d;return f.showRanged?(d=f.showCompare&&f.selection&&f.selection[1]?moment().range(Math.min(f.selection[0].start,f.selection[1].start),Math.max(f.selection[0].end,f.selection[1].end)):f.selection&&f.selection[0]?f.selection[0]:!1,f.range=null!=f.noFutureDates?d?(a=d.end.clone().endOf("month").startOf("day"),c=a.clone().subtract(2,"months").startOf("month").startOf("day"),moment().range(c,a)):moment().range(moment().startOf("month").subtract(2,"month").startOf("day"),moment().endOf("month").startOf("day")):f.selection&&f.selection[0]?(c=f.selection[0].start.clone().startOf("month").startOf("day"),a=c.clone().add(2,"months").endOf("month").startOf("day"),moment().range(c,a)):moment().range(moment().startOf("month").subtract(1,"month").startOf("day"),moment().endOf("month").add(1,"month").startOf("day"))):(b=l(0),f.selection[0]=!1,f.selection[0]=b||!1,f.date=moment(b)||moment(),f.range=moment().range(moment(f.date).startOf("month"),moment(f.date).endOf("month")))},k=function(){var a,b,c,e;if(f.showRanged&&f.selection[f.cursel]){for(e=f.quickList,b=0,c=e.length;c>b;b++)if(a=e[b],a.range!==d&&f.selection[f.cursel].start.startOf("day").unix()===a.range.start.startOf("day").unix()&&f.selection[f.cursel].end.startOf("day").unix()===a.range.end.startOf("day").unix())return f.quick=a.range,void m();return f.quick=d,m(!0)}},n=function(){var b,c,d,e,g,h;for(f.months=[],d=12*f.range.start.year()+f.range.start.month(),c=moment().startOf("week").day(),f.range.by("days",function(b){var e,g,h,i,j,k,l,m,n,o;if(g=b.day()-c,0>g&&(g=7+g),j=12*b.year()+b.month()-d,l=parseInt((7+b.date()-g)/7),k=[],h=!1,f.showRanged){o=f.selection;for(i in o)a.call(o,i)&&(e=o[i],f.start&&parseInt(i)===parseInt(f.cursel)?(k[i]=b.isSame(f.start),h=b<f.start):k[i]=e&&e.contains(b))}else k[0]=b.isSame(f.selection[0]),f.pastDates&&(h=moment().diff(b,"days")>0);return null!=f.noFutureDates&&(h=h||moment().diff(b,"days")<0),(m=f.months)[j]||(m[j]={name:b.format("MMMM YYYY"),weeks:[]}),(n=f.months[j].weeks)[l]||(n[l]=[]),f.months[j].weeks[l][g]={date:b,selected:k,disabled:h,start:f.start&&f.start.unix()===b.unix()}}),h=f.months,e=0,g=h.length;g>e;e++)b=h[e],b.weeks[0]||b.weeks.splice(0,1);return k()},f.show=function(){return f.showCompare?(f.selection[0]=f.model[0],f.selection[1]=f.model[1]):(f.selection[0]=f.model,f.selection[1]=void 0),j(),n(),f.visible=!0},f.hide=function(a){return null!=a&&"function"==typeof a.stopPropagation&&a.stopPropagation(),f.visible=!1,f.start=null},f.prevent_select=function(a){return null!=a&&"function"==typeof a.stopPropagation?a.stopPropagation():void 0},f.ok=function(a){return null!=a&&"function"==typeof a.stopPropagation&&a.stopPropagation(),f.model=f.model||[],f.showCompare?(f.model[0]=f.selection[0],f.model[1]=f.selection[1]):f.model=f.selection[0],c(function(){return f.callback?f.callback():void 0}),f.hide()},f.select=function(a,b){return null!=b&&"function"==typeof b.stopPropagation&&b.stopPropagation(),a.disabled?void 0:(f.showRanged?(f.selecting=!f.selecting,f.selecting?f.start=a.date:(f.selection[f.cursel]=moment().range(f.start,a.date),f.start=null)):f.selection[f.cursel]=moment(a.date),n())},f.move=function(a,b){return null!=b&&"function"==typeof b.stopPropagation&&b.stopPropagation(),f.showRanged?f.range=moment().range(f.range.start.add(a,"months").startOf("month").startOf("day"),f.range.start.clone().add(2,"months").endOf("month").startOf("day")):(f.date.add(a,"months"),f.range=moment().range(moment(f.date).startOf("month"),moment(f.date).endOf("month"))),n()},f.handlePickerClick=function(a){return null!=a&&"function"==typeof a.stopPropagation?a.stopPropagation():void 0},f.$watch("quick",function(a){return a&&a!==d?(f.selection[f.cursel]=f.quick,f.selecting=!1,f.start=null,j(),n()):void 0}),f.$watch("customSelectOptions",function(a){return"undefined"!=typeof customSelectOptions&&null!==customSelectOptions?f.quickListDefinitions=a:void 0}),i=b(angular.element(e))(f),g.append(i),g.bind("click",function(a){return null!=a&&"function"==typeof a.stopPropagation&&a.stopPropagation(),f.$apply(function(){return f.visible?f.hide():f.show()})}),h=function(){return f.$apply(function(){return f.hide()}),!0},angular.element(document).bind("click",h),f.$on("$destroy",function(){return angular.element(document).unbind("click",h)}),m(),j(),n()}}}])}).call(this);